variant: fcos
version: 1.6.0
# Cockpit via Podman Quadlet
# Run the official cockpit/ws container in privileged mode using host networking.
storage:
  files:
    # Ensure password auth is allowed for Cockpit login (optional if using other auth)
    - path: /etc/ssh/sshd_config.d/02-enable-passwords.conf
      mode: 0644
      contents:
        inline: |
          PasswordAuthentication yes
    # Podman Quadlet: define the Cockpit container
    - path: /etc/containers/systemd/cockpit.container
      mode: 0644
      contents:
        inline: |
          [Unit]
          Description=Cockpit Web Service Container
          Documentation=man:cockpit-ws(8)
          After=network-online.target
          Wants=network-online.target

          [Container]
          Image=cockpit/ws
          ContainerName=cockpit
          PublishPort=9090:9090
          Volume=/:/host:ro
          Environment=COCKPIT_REMOTE_PEER=1
          Privileged=true
          SecurityLabelDisable=true
          Pull=always

          [Service]
          Restart=always
          RestartSec=5
          TimeoutStartSec=300
          TimeoutStopSec=30

          [Install]
          WantedBy=multi-user.target
# Quadlet will synthesize cockpit.service from cockpit.container and apply [Install].
