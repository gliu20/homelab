variant: fcos
version: 1.6.0
storage:
  directories:
    - path: /home/core/.config/containers/systemd
      mode: 0755
      user:
        name: core
      group:
        name: core
    - path: /home/core/pods/minecraft/data
      mode: 0755
      user:
        name: core
      group:
        name: core
  files:
    - path: /var/lib/systemd/linger/core
      mode: 0644
    - path: /home/core/.config/containers/systemd/minecraft.volume
      mode: 0644
      user:
        name: core
      group:
        name: core
      contents:
        inline: |
          [Volume]
          Driver=local
          Device=/home/core/pods/minecraft/data
          Options=type=bind
    - path: /home/core/.config/containers/systemd/minecraft.container
      mode: 0644
      user:
        name: core
      group:
        name: core
      contents:
        inline: |
          [Unit]
          Description=Minecraft Server
          After=network-online.target minecraft.volume
          Requires=minecraft.volume
          [Container]
          Image=docker.io/itzg/minecraft-server:java24-graalvm
          ContainerName=minecraft-server
          PublishPort=25565:25565
          Volume=minecraft.volume:/data
          Environment=EULA=TRUE
          AutoUpdate=registry
          # Security hardening - run as non-root user
          User=1000
          Group=1000
          # Logging configuration
          LogDriver=journald
          # Additional security settings
          NoNewPrivileges=true
          DropCapability=ALL
          AddCapability=NET_BIND_SERVICE
          ReadOnly=false
          [Service]
          Restart=always
          [Install]
          WantedBy=multi-user.target